import json
from algosdk.v2client import algod
from algosdk import account, mnemonic
from algosdk.future.transaction import AssetConfigTxn, AssetTransferTxn, AssetFreezeTxn, wait_for_confirmation, AssetCloseOutTxn


# Local Algorand node URL and API token
algod_address = "http://host:port"
algod_token = "algod.token"
algod_client = algod.AlgodClient(algod_token=algod_token, algod_address=algod_address)

# Replace with your own 25-word Algorand mnemonic phrase
mnemonic_secret = ""
dest_acct = "The account address to send assets to"


asalist = [564407685, 510337930, 564399300, 564402651, 767338919, 804672331, 814607736, 729124514, 805282993, 776547459, 776545878, 779114139, 805958722, 800501027, 807092209, 357140534, 807447333, 807671073, 357138011, 716365251, 808375958, 801552818, 810027391, 810030300, 810028491, 811070620, 811701084, 750692064, 812013965, 462330663, 548454133, 801403466, 801420992, 801156659, 809528563, 813621336, 810030483, 810031392, 810028102, 810028790, 456717288, 810028926, 588147645, 689562014, 613705579, 573393467, 689092612, 878567994, 892575482, 892579429, 819302346, 818328607, 892582444, 620018242, 892584089, 855072961, 630267436, 630277359, 820058335, 810031075, 823851195, 810029741, 823849841, 823831770, 825234484, 817706069, 805176846, 823866851, 823865802, 826197807, 823840419, 810028298, 810028545, 827508290, 770496860, 810030622, 810029910, 830424219, 799486216, 811168068, 803333070, 804274309, 804268108, 803334278, 677040929, 832445857, 846876650, 846876056, 846876153, 846876537, 846876228, 846876461, 846876401, 846876332, 846876002, 846876593, 805179512, 846876724, 829992960, 833778238, 836961485, 836963187, 798232651, 566247159, 843747214, 844776290, 838267563, 837370223, 780043954, 765793705, 841567055, 823855112, 411031906, 834064914, 834062798, 828388459, 828387144, 825240914, 825241629, 410827965, 564410497, 855449457, 843347688, 844499083, 564419028, 564395147, 564390122, 564428956, 564412499, 564416094, 564428134, 564396332, 795820773, 832298134, 820565882, 816640859, 863891560, 865615993, 810026923, 823841522, 805171481, 860143320, 800779945, 848149760, 827818088, 773530348, 852929964, 795687358, 850652872, 810029660, 846017564, 846017740, 846004371, 846021384, 846007148, 846015798, 846019101, 846012631, 846025166, 846015778, 786157368, 602130961, 851319442, 851319796, 851319620, 851319420, 851319748, 927750013, 927730201, 927695964, 626874094, 850895568, 816952905, 857979115, 723023669, 848912296, 854120917, 850817885, 841907615, 841940603, 848684925, 854123726, 824765948, 840082815, 840083916, 858698540, 838997347, 858154409, 857229787, 858145790, 858149642, 763130961, 586905444, 590258059, 860289069, 838998632, 838990563, 849838737, 859256335, 859393187, 859295072, 859241454, 860146933, 860141440, 860147682, 860147316, 860148485, 860145362, 846874377, 906586599, 827584445, 859125886, 859376915, 866735671, 853654911, 805170298, 867652025, 867652300, 609384512, 609477591, 609306237, 609410895, 847805889, 850680592, 1009078085, 836033628, 867641396, 867645886, 867642479, 867641868, 895025507, 895035541, 873305594, 895021715, 1004880301, 31566704, 902908398, 672859343, 810028866, 886770753, 841167932, 887782497, 562170135, 886640506, 886409525, 886702197, 886651130, 886654526, 894897558, 894896146, 357139542, 895033992, 864259181, 864249404, 864258730, 864259028, 439932508, 630693622, 888058494, 888376749, 569892674, 569630015, 889785152, 889786171, 889786840, 890493005, 877568306, 712081102, 854788420, 790172447, 890075135, 890058297, 782142063, 757049802, 757105835, 891523474, 870564544, 870460346, 809485119, 824688821, 824812398, 893093121, 890370679, 772457385, 891374928, 892264748, 845694050, 849915638, 809496440, 892302688, 892336337, 888543799, 888514769, 888534735, 888498353, 892325794, 886957975, 886963586, 845685591, 859852946, 886951747, 538568960, 886971669, 886965001, 886955915, 886967941, 894544971, 886952920, 630207958, 669136655, 607232777, 555037244, 762174042, 717036569, 717032668, 717033805, 445728752, 633268572, 700906083, 894452856, 449269434, 772300887, 719092605, 747778557, 839004730, 837353495, 848707386, 786407405, 767707085, 811675225, 703527976, 830344924, 723368815, 722814318, 834314965, 717941284, 720585806, 719771273, 718539163, 719521256, 716921672, 749477449, 749495409, 747902851, 922266839, 914569311, 899490737, 894446936, 767985699, 864204520, 863082124, 864213517, 498115148, 899679258, 900834515, 551854746, 840810637, 840677494, 840717502, 840747616, 840752776, 848685288, 904645789, 904645903, 768335653, 703246502, 703269148, 641115592, 600097141, 703267654, 703279520, 588140942, 669136073, 620013999, 626990065, 548016947, 504541874, 630203280, 503846085, 673609935, 396042371, 513981489, 446818296, 649050296, 618559460, 613356633, 631795057, 563841988, 600333355, 423008680, 680264251, 680265618, 671977571, 637900165, 637899148, 637897720, 569827498, 548380792, 316262195, 245941466, 686117781, 602611593, 690765937, 690766792, 617292616, 691362637, 691371981, 663589150, 669805516, 648315112, 645214012, 549040337, 579922780, 695184366, 670913175, 544344106, 509648609, 515539300, 519012607, 542789067, 507934532, 605361992, 463919053, 474689452, 628203876, 642999006, 558066799, 408913546, 375270154, 389131143, 408905532, 408913934, 408914227, 665650194, 695914050, 458830924, 614822201, 490146814, 490139078, 493271743, 490141855, 459142744, 498127718, 586272795, 586330803, 614835807, 614614783, 701184634, 696384768, 699371763, 700882175, 700882780, 660137944, 702018637, 702019108, 702020209, 702022486, 702020808, 702026388, 702030189, 702036500, 702045298, 702050891, 436877337, 659218193, 654317522, 701184610, 700905820, 700905951, 700906158, 700906171, 700906324, 700906525, 497890668, 435560150, 435584100, 436299245, 436573571, 705264941, 692646432, 601443874, 599862112, 692343802, 663566637, 542578312, 703247534, 703265781, 703266311, 703272298, 703276180, 663628047, 688460066, 703252616, 703265549, 703264419, 703262510, 582587748, 587640359, 600594469, 703281571, 706361065, 648207675, 364102128, 703267681, 715960001, 708926773, 708931725, 698637056, 329110405, 704804574, 137594422, 702696587, 330125569, 522865771, 536184602, 538548762, 538549550, 538549856, 538550194, 538556283, 538569256, 329660239, 697464317, 718162792, 702805792, 652321423, 584187652, 652319233, 716671143, 716705691, 720706842, 720706704, 692044012, 718033998, 933973163, 717687975, 708157074, 546297252, 557870326, 607518574, 708223803, 708211506, 707075811, 717035143, 717033088, 651499550, 691814966, 708188070, 708171134, 713703168, 713708881, 414683521, 624704868, 346725947, 448774181, 472001317, 719722092, 704485483, 704486275, 507928715, 711360132, 407035095, 371626454, 407014851, 688096668, 395351053, 463274157, 600139418, 463895398, 463928045, 462403077, 599397693, 720586709, 721349663, 721338323, 721344604, 246516580, 721272465, 721299357, 721281917, 721387135, 615459880, 576983647, 720838064, 716362863, 466716175, 872536957, 871516085, 570953586, 377601039, 682271403, 723799377, 742871622, 727661426, 721239050, 661119267, 661117674, 709369420, 723258190, 646462592, 730486367, 660322862, 735580612, 596314000, 735617702, 735614335, 735421962, 711852398, 547252973, 738692169, 711363327, 738496844, 701005516, 639795589, 740716596, 645279545, 719089361, 708285165, 393537671, 743147560, 694264553, 463696238, 694075555, 713428985, 781520908, 768065419, 685769398, 886966183, 768346476, 629676031, 685773213, 745657684, 646269213, 637341606, 608502416, 546885803, 627942192, 688138420, 707425038, 567891920, 535515394, 625883367, 741969678, 635124839, 541388003, 745847394, 685402029, 454462867, 658140851, 639806749, 629673924, 706162807, 754455910, 749841008, 717139001, 1004207443, 750685089, 745843360, 749388963, 745841273, 749389840, 700104174, 590573867, 740508671, 750576592, 722364568, 702354571, 748391180, 753602513, 685061334, 753972772, 752312521, 754916188, 741167867, 755560321, 604580311, 637282360, 637280361, 755467710, 755831227, 756077477, 750332104, 754868732, 748408687, 615595945, 711361819, 757074805, 755509580, 740188142, 757097455, 696085104, 696086436, 436595815, 758687574, 742636795, 749487015, 485339058, 741672026, 757800795, 1004204353, 740192843, 715910933, 715907998, 624700796, 740189210, 744074283, 741433835, 760805018, 905977058, 708046390, 761473065, 763020122, 762953504, 762952233, 614909113, 757339796, 757377463, 897317461, 713686035, 764006942, 908641760, 765070113, 765229480, 896677468, 766569497, 766623858, 460206390, 762095528, 765809647, 768053041, 760015374, 768467594, 948178664, 764559570, 918340716, 764553616, 767658327, 770685493, 632403255, 601777937, 777230810, 767559568, 771620804, 768340050, 768098875, 768449983, 768282490, 768353874, 436751835, 773636785, 770942446, 770941249, 770937679, 359110490, 774292932, 777607843, 757094600, 774895569, 775470692, 428588978, 913652221, 778098428, 776071196, 777148851, 778887769, 778890964, 778895887, 778904144, 762054994, 762142415, 769373520, 778256814, 778055778, 777885925, 776717962, 777981216, 770498865, 776223545, 764533124, 782134170, 782144436, 768345175, 772582549, 781107445, 780578731, 789711726, 784839089, 784838666, 785152155, 783585909, 765805988, 627999675, 786951221, 786427686, 755575315, 631794582, 788094505, 787648458, 787695593, 775567313, 775568992, 775569959, 600453736, 773118063, 550894701, 810030176, 742386877, 671556774, 786951798, 795387138, 758251941, 795281004, 704731220, 702688376, 797345889, 795200296, 749384721, 755063520, 798495055, 798345076, 798485545, 798488670, 793931532, 771347433, 791985576, 791988555, 896678110, 910874376, 600449494, 600429887, 843745188, 843730588, 810029976, 896677421, 896677035, 896641598, 895939731, 895947394, 896676336, 895943862, 896632423, 859282663, 823852562, 909942346, 909941390, 904890246, 910851230, 899025413, 918541309, 918539128, 918540864, 908642445, 912640183, 417708610, 845317425, 909932024, 909925665, 909936973, 925851354, 928814791, 926048128, 929951495, 817705889, 651435733, 810029414, 843737912, 843715966, 458908359, 789147544, 468446455, 670728823, 781518307, 823829473, 810028657, 810027058, 810030341, 823836837, 810027178, 810030394, 810028717, 810028021, 823859684, 886951171, 886951173, 886951179, 886951183, 886951252, 886951254, 886951266, 886951270, 886951272, 886452112, 805176268, 805182830, 805173804, 805182629, 805184872, 485183134, 777828711, 810031230, 810031006, 810029781, 884585914, 810030231, 945459320, 810027969, 810030806, 624410813, 946584270, 946583214, 946589882, 946584110, 946629260, 779728351, 810029131, 946563485, 946767235, 956312346, 956314859, 956319160, 828794714, 950862436, 864699877, 958410854, 954239872, 941850467, 941850142, 941868708, 941883791, 941806729, 941850473, 941850064, 941869676, 941855319, 941868463, 400593267, 721288793, 721390068, 903803507, 731200486, 973882240, 552752491, 886951244, 977333091, 977333617, 823842973, 922268784, 922264924, 922270797, 810029372, 922272972, 810031134, 810029850, 823858383, 142838028, 979801680, 979530542, 925885396, 974794342, 974817085, 810031643, 981958330, 613608234, 984455465, 974441921, 1032057027, 794485730, 985666542, 985666555, 985666591, 985666524, 985666550, 947810335, 559219992, 887361695, 813475513, 813831369, 840985106, 1004744674, 987778329, 917962457, 1002680104, 989639177, 870088230, 452047208, 408898501, 833815143, 1004880006, 1005738419, 953035899, 411085773, 1006571183, 886972499, 1004203365, 1026728389, 1004202574, 1004205246, 1004195413, 1004205511, 1004205606, 1004196563, 1004202514, 1004197529, 1004202468, 1004203299, 1004194277, 1004206760, 1004195679, 1004202071, 1004203534, 1004207757, 983061203, 886959997, 1009435743, 810029071, 956319319, 810029453, 523683256, 894250197, 987777995, 1010385532, 1015835388, 1015836244, 1015837349, 810027674, 892581033, 1015838528, 823863312, 1014771012, 912528141, 925142771, 1006070449, 721340136, 721410617, 721410027, 721268073, 721338156, 721323572, 721261472, 568789622, 1021956834, 1021958004, 930375826, 987775778, 987776631, 568822516, 1028143688, 1028146097, 1028145164, 1012412807, 1017052236, 964287901, 907459439, 1023137784, 658399558, 931177338, 854112899, 1009649297, 1017957566, 1018062228, 1017949270, 878951062, 434881568, 1019091874, 1012641032, 1004881483, 1005737887, 1012640576, 1000870705, 987777257, 987777543, 987777383, 987776937, 697414080, 1018768611, 697419008, 1024192485, 851077120, 995483781, 845691952, 1002870431, 1004717150, 683274868, 1017804597, 1017841071, 1018086550, 1017920492, 1017795233, 1004725965, 1018462370, 809610090, 886960707, 1032059435, 1034392199, 1034397922, 1034403003, 977333395, 810028984, 810029223, 823827475, 810030949, 805177050, 1018078578, 493895498, 890699142, 1032243759, 1032580007, 1032584858, 987777495, 987776771, 987777715, 987776585, 987777567, 987777229, 987777925, 987777876, 708624210, 485354931, 895780292, 522839621, 676326808, 609416807, 864570220, 797382233, 891443534, 603513338, 1039586281, 1039587170, 1039585264, 810027235, 810029181, 810027302, 805175020, 810031738, 1048627611, 548381968, 1042867088, 987777288, 987776249, 987777472, 891455994, 987776751, 987778144, 987776125, 987777640, 987775811, 545140069, 1046071432, 1046074576, 1046073145, 810027874, 805186253, 810031485, 810029323, 810028413, 823833870, 823844597, 810030566, 1011328725, 1004718143, 925132121, 983064747, 1050929667, 751294723, 1044171156, 544217506, 1044101791, 832356628, 796490640, 937769492, 937831505, 810029622, 823853944, 823838469, 810028611, 935240820, 949269096, 1021960439, 805178556, 787168529, 875415272, 982719503, 987778052, 987777427, 987777294, 987775959, 883584774, 987778056, 719923979, 790791967, 791989229, 791971036, 789316578, 781522367, 702690655, 892359989, 857320817, 1040783833, 393495312, 992507148, 753137719, 939020031, 939024529, 939022177, 939021760, 939018775, 629831036, 629818456, 629812043, 629806853, 629797850, 629740234, 629737414, 629736463, 464496018, 464493923, 464493733, 464482154, 464413893]
#LPs in Gov - asalist = [1002716026, 753241364] 


#   Utility function used to print asset holding for account and assetid
def print_asset_holding(algodclient, account, assetid):
	# note: if you have an indexer instance available it is easier to just use this
	# response = myindexer.accounts(asset_id = assetid)
	# then loop thru the accounts returned and match the account you are looking for
	account_info = algodclient.account_info(account)
	idx = 0
	for my_account_info in account_info['assets']:
		scrutinized_asset = account_info['assets'][idx]
		idx = idx + 1
		if (scrutinized_asset['asset-id'] == assetid):
			print("Asset ID: {}".format(scrutinized_asset['asset-id']))
			print(json.dumps(scrutinized_asset, indent=4))
			break


def mvasa(asset_id):
	try:

		pk = mnemonic.to_public_key(mnemonic_secret)
		sk = mnemonic.to_private_key(mnemonic_secret)

		params = algod_client.suggested_params()
		# comment these two lines if you want to use suggested params
		params.fee = 1000
		params.flat_fee = True

		account_info = algod_client.account_info(pk)
		holding = None
		idx = 0
		assetamt = 0
		for my_account_info in account_info['assets']:
			scrutinized_asset = account_info['assets'][idx]
			idx = idx + 1
			if (scrutinized_asset['asset-id'] == asset_id):
				holding = True
				assetamt = int(scrutinized_asset['amount'])
				break

		if assetamt == 0:
			# Use the AssetTransferTxn class to transfer assets and opt-in
			txn = AssetCloseOutTxn(
				sender=pk,
				sp=params,
				receiver=dest_acct,
				index=asset_id)
			stxn = txn.sign(sk)
			txid = algod_client.send_transaction(stxn)
			print(txid)
			# Wait for the transaction to be confirmed
			wait_for_confirmation(algod_client, txid)
			# Now check the asset holding for that account.
			# This should now show a holding with a balance of 0.
			print_asset_holding(algod_client, pk, asset_id)

	except Exception as err:
		print(f"Unexpected {err=}, {type(err)=}")


for asset_id in asalist:
	print (asset_id)
	mvasa(asset_id)
